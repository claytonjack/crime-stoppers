<app-header title="Suspect Details" [showMenuButton]="false">
	<ion-button slot="start" (click)="goBack()" aria-label="Go back">
		<ng-icon slot="icon-only" name="bootstrapArrowLeft"></ng-icon>
	</ion-button>
</app-header>

<ion-content [fullscreen]="true">
	<!-- Loading State -->
	@if (isLoading()) {
	<div class="loading-container">
		<ion-spinner name="crescent"></ion-spinner>
		<ion-text>
			<p>Loading suspect...</p>
		</ion-text>
	</div>
	}

	<!-- Error State -->
	@if (error() && !isLoading()) {
	<div class="error-container">
		<ng-icon name="bootstrapExclamationTriangle" size="64" color="danger"></ng-icon>
		<ion-text color="danger">
			<h3>Error</h3>
			<p>{{ error() }}</p>
		</ion-text>
		<ion-button fill="outline" (click)="goBack()">
			Go Back
		</ion-button>
	</div>
	}

	<!-- Suspect Content -->
	@if (suspect() && !isLoading() && !error()) {
	<div class="suspect-content">
		<!-- Images Carousel -->
		@if (suspect()!.Images && suspect()!.Images!.length > 0) {
		<div class="images-section">
			<swiper-container slides-per-view="1" navigation="true" pagination="true" loop="false" class="suspect-swiper"
				(swiperslidechange)="onSwiperSlideChange($event)">
				@for (image of suspect()!.Images!; track image.documentId; let i = $index) {
				<swiper-slide>
					<div class="slide-container">
						<ion-img [src]="getImageUrl(image.url)" [alt]="image.alternativeText || suspect()!.Name"
							(click)="onImageClick(i)" class="slide-image" loading="lazy">
						</ion-img>
					</div>
				</swiper-slide>
				}
			</swiper-container>

			<!-- Image Counter -->
			@if (suspect()!.Images!.length > 1) {
			<div class="image-counter">
				{{ selectedImageIndex() + 1 }} / {{ suspect()!.Images!.length }}
			</div>
			}
		</div>
		}

		<!-- Suspect Information Card -->
		<div class="info-section">
			<div class="suspect-card">
				<div class="card-header-section">
					<h1 class="suspect-title">{{ suspect()!.Name }}</h1>
					<div class="suspect-basic-info">
						@if (suspect()!.Crime) {
						<div class="info-item">
							<ng-icon name="bootstrapExclamationTriangle"></ng-icon>
							<span class="info-label">Crime:</span>
							<span class="info-value">{{ suspect()!.Crime }}</span>
						</div>
						}
						@if (suspect()!.Scene) {
						<div class="info-item">
							<ng-icon name="bootstrapPinAngle"></ng-icon>
							<span class="info-label">Scene:</span>
							<span class="info-value">{{ suspect()!.Scene }}</span>
						</div>
						}
						@if (suspect()!.Residence) {
						<div class="info-item">
							<ng-icon name="bootstrapHouseDoor"></ng-icon>
							<span class="info-label">Residence:</span>
							<span class="info-value">{{ suspect()!.Residence }}</span>
						</div>
						}
						@if (suspect()!.Age) {
						<div class="info-item">
							<ng-icon name="bootstrapCake2"></ng-icon>
							<span class="info-label">Age:</span>
							<span class="info-value">{{ suspect()!.Age }}</span>
						</div>
						}
						@if (suspect()!.Height) {
						<div class="info-item">
							<ng-icon name="bootstrapArrowsExpand"></ng-icon>
							<span class="info-label">Height:</span>
							<span class="info-value">{{ suspect()!.Height }}</span>
						</div>
						}
						@if (suspect()!.Weight) {
						<div class="info-item">
							<ng-icon name="bootstrapArrowsExpandVertical"></ng-icon>
							<span class="info-label">Weight:</span>
							<span class="info-value">{{ suspect()!.Weight }}</span>
						</div>
						}
					</div>
				</div>

				@if (suspect()!.Body) {
				<div class="card-content-section">
					<div class="suspect-body">
						<ion-text>
							<div [innerHTML]="suspect()!.Body"></div>
						</ion-text>
					</div>
				</div>
				}
			</div>
		</div>
	</div>
	}

	<!-- Full-size Image Modal -->
	<ion-modal [isOpen]="isImageModalOpen()" (didDismiss)="closeImageModal()">
		<ng-template>
			<ion-header>
				<ion-toolbar>
					<ion-title>Image {{ selectedImageIndex() + 1 }} of {{ suspect()?.Images?.length || 0 }}</ion-title>
					<ion-buttons slot="end">
						<ion-button (click)="closeImageModal()">
							<ng-icon name="bootstrapX" slot="icon-only"></ng-icon>
						</ion-button>
					</ion-buttons>
				</ion-toolbar>
			</ion-header>

			<ion-content>
				@if (suspect()?.Images && suspect()!.Images![selectedImageIndex()]) {
				<div class="modal-image-container">
					<ion-img [src]="getImageUrl(suspect()!.Images![selectedImageIndex()].url)"
						[alt]="suspect()!.Images![selectedImageIndex()].alternativeText || suspect()!.Name" class="modal-image"
						loading="lazy">
					</ion-img>
				</div>
				}
			</ion-content>
		</ng-template>
	</ion-modal>
	<!-- Reward and Contact Us (static sections) -->
	<div class="bottom-static-section">
		<ion-card class="reward-card">
			<ion-card-header>
				<ion-card-title>
					<ng-icon name="bootstrapCash" style="margin-right:8px;"></ng-icon>
					Reward
				</ion-card-title>
			</ion-card-header>
			<ion-card-content>
				<ion-text>
					Cash rewards of up to <b>$2,000</b> are available for information leading to an arrest or the solving of a
					crime.
				</ion-text>
			</ion-card-content>
		</ion-card>

		<ion-card class="contact-card">
			<ion-card-header>
				<ion-card-title>
					<ng-icon name="bootstrapTelephone" style="margin-right:8px;"></ng-icon>
					Contact Us
				</ion-card-title>
			</ion-card-header>
			<ion-card-content>
				<ion-text>
					If seen, <b>do not approach the suspect</b>.<br>
					Instead, Call <b>9-1-1</b> or contact Crime Stoppers: <a href="tel:1-800-222-8477">1-800-222-8477</a>
				</ion-text>
			</ion-card-content>
		</ion-card>
	</div>
</ion-content>