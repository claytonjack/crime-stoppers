<app-header [title]="'feature.suspectDetails.headerTitle' | translate" [showMenuButton]="false">
	<ion-button slot="start" (click)="goBack()" [attr.aria-label]="'core.common.aria.goBack' | translate">
		<ng-icon slot="icon-only" name="bootstrapArrowLeft" class="icon-size"></ng-icon>
	</ion-button>
</app-header>

<ion-content [fullscreen]="true" role="main" aria-live="polite">
	@if (isLoading()) {
	<div class="loading-container" role="status" aria-live="polite">
		<ion-spinner name="crescent" aria-hidden="true"></ion-spinner>
		<ion-text>
			<p>{{ 'feature.suspectDetails.loading' | translate }}</p>
		</ion-text>
	</div>
	}

	@if (error() && !isLoading()) {
	<div class="error-container" role="alert" aria-live="assertive">
		<ng-icon name="bootstrapExclamationTriangle" size="64" aria-hidden="true"></ng-icon>
		<ion-text color="danger">
			<h3>{{ 'core.common.error' | translate }}</h3>
			<p>{{ error() | translate }}</p>
		</ion-text>
		<ion-button fill="outline" (click)="goBack()" [attr.aria-label]="'core.common.aria.goBackToPrevious' | translate">
			{{ 'core.common.goBack' | translate }}
		</ion-button>
	</div>
	}

	@if (suspect() && !isLoading() && !error()) {
	<div class="content-wrapper" tabindex="0" [attr.aria-label]="'feature.suspectDetails.contentAriaLabel' | translate">
		@if (suspect()!.Images && suspect()!.Images!.length > 0) {
		<div class="images-section" role="region"
			[attr.aria-label]="'feature.suspectDetails.imageGalleryAriaLabel' | translate">
			<swiper-container slides-per-view="1" navigation="true" pagination="true" loop="false" class="detail-swiper"
				(swiperslidechange)="onSwiperSlideChange($event)" aria-roledescription="carousel">
				@for (image of suspect()!.Images!; track image.documentId; let i = $index) {
				<swiper-slide>
					<div class="slide-container suspect-image-wrapper">
						<ion-img [src]="getImageUrl(image.url)" [alt]="image.alternativeText || suspect()!.Name"
							(click)="onImageClick(i)" class="suspect-image" loading="lazy" tabindex="0" role="img"
							[attr.aria-label]="('feature.suspectDetails.imageAriaLabel' | translate:{ index: i + 1, total: suspect()!.Images!.length })">
						</ion-img>
					</div>
				</swiper-slide>
				}
			</swiper-container>

			@if (suspect()!.Images!.length > 1) {
			<div class="image-counter" aria-live="polite" tabindex="0">
				{{ selectedImageIndex() + 1 }} / {{ suspect()!.Images!.length }}
			</div>
			}
		</div>
		}

		<div class="info-section" role="region" [attr.aria-label]="'feature.suspectDetails.infoAriaLabel' | translate">
			<div class="info-card">
				<div class="card-header-section">
					<h1 class="detail-title" tabindex="0">{{ suspect()!.Name }}</h1>
					<div class="suspect-attributes">
						@if (suspect()!.Crime) {
						<div class="metadata-item">
							<ng-icon name="bootstrapExclamationTriangle" aria-hidden="true"></ng-icon>
							<span class="attribute-label">{{ 'feature.suspectDetails.attributes.crime' | translate }}:</span>
							<span class="attribute-value">{{ suspect()!.Crime }}</span>
						</div>
						}
						@if (suspect()!.Scene) {
						<div class="metadata-item">
							<ng-icon name="bootstrapPinAngle" aria-hidden="true"></ng-icon>
							<span class="attribute-label">{{ 'feature.suspectDetails.attributes.scene' | translate }}:</span>
							<span class="attribute-value">{{ suspect()!.Scene }}</span>
						</div>
						}
						@if (suspect()!.Residence) {
						<div class="metadata-item">
							<ng-icon name="bootstrapHouseDoor" aria-hidden="true"></ng-icon>
							<span class="attribute-label">{{ 'feature.suspectDetails.attributes.residence' | translate }}:</span>
							<span class="attribute-value">{{ suspect()!.Residence }}</span>
						</div>
						}
						@if (suspect()!.Age) {
						<div class="metadata-item">
							<ng-icon name="bootstrapCake2" aria-hidden="true"></ng-icon>
							<span class="attribute-label">{{ 'feature.suspectDetails.attributes.age' | translate }}:</span>
							<span class="attribute-value">{{ suspect()!.Age }}</span>
						</div>
						}
						@if (suspect()!.Height) {
						<div class="metadata-item">
							<ng-icon name="bootstrapArrowsExpand" aria-hidden="true"></ng-icon>
							<span class="attribute-label">{{ 'feature.suspectDetails.attributes.height' | translate }}:</span>
							<span class="attribute-value">{{ suspect()!.Height }}</span>
						</div>
						}
						@if (suspect()!.Weight) {
						<div class="metadata-item">
							<ng-icon name="bootstrapArrowsExpandVertical" aria-hidden="true"></ng-icon>
							<span class="attribute-label">{{ 'feature.suspectDetails.attributes.weight' | translate }}:</span>
							<span class="attribute-value">{{ suspect()!.Weight }}</span>
						</div>
						}
					</div>
				</div>

				@if (suspect()!.Body) {
				<div class="card-content-section" role="region"
					[attr.aria-label]="'feature.suspectDetails.descriptionAriaLabel' | translate">
					<div class="detail-body">
						<ion-text>
							<div [innerHTML]="suspect()!.Body"></div>
						</ion-text>
					</div>
				</div>
				}
			</div>

			<div class="additional-info-section" role="region"
				[attr.aria-label]="'feature.suspectDetails.additionalInfoAriaLabel' | translate">
				<ion-card class="info-highlight-card">
					<ion-card-header>
						<ion-card-title>
							<ng-icon name="bootstrapCash" aria-hidden="true"></ng-icon>
							<span>{{ 'feature.suspectDetails.cards.reward.title' | translate }}</span>
						</ion-card-title>
					</ion-card-header>
					<ion-card-content>
						<ion-text [innerHTML]="'feature.suspectDetails.cards.reward.description' | translate">
						</ion-text>
					</ion-card-content>
				</ion-card>

				<ion-card class="info-highlight-card">
					<ion-card-header>
						<ion-card-title>
							<ng-icon name="bootstrapTelephone" aria-hidden="true"></ng-icon>
							<span>{{ 'feature.suspectDetails.cards.contact.title' | translate }}</span>
						</ion-card-title>
					</ion-card-header>
					<ion-card-content>
						<ion-text [innerHTML]="'feature.suspectDetails.cards.contact.description' | translate">
						</ion-text>
					</ion-card-content>
				</ion-card>
			</div>
		</div>
	</div>
	}

	<ion-modal [isOpen]="isImageModalOpen()" (didDismiss)="closeImageModal()"
		[attr.aria-label]="'feature.suspectDetails.imageModalAriaLabel' | translate">
		<ng-template>
			<ion-header>
				<ion-toolbar>
					<ion-title aria-live="polite">
						{{ 'core.common.modal.imageTitle' | translate:{ current: selectedImageIndex() + 1, total:
						suspect()?.Images?.length || 0 } }}
					</ion-title>
					<ion-buttons slot="end">
						<ion-button (click)="closeImageModal()" [attr.aria-label]="'core.common.aria.closeImageViewer' | translate">
							<ng-icon name="bootstrapX" slot="icon-only"></ng-icon>
						</ion-button>
					</ion-buttons>
				</ion-toolbar>
			</ion-header>

			<ion-content role="region" [attr.aria-label]="'feature.suspectDetails.fullSizeImageAriaLabel' | translate">
				@if (suspect()?.Images && suspect()!.Images![selectedImageIndex()]) {
				<div class="modal-image-container">
					<ion-img [src]="getImageUrl(suspect()!.Images![selectedImageIndex()].url)"
						[alt]="suspect()!.Images![selectedImageIndex()].alternativeText || suspect()!.Name" class="modal-image"
						loading="lazy">
					</ion-img>
				</div>
				}
			</ion-content>
		</ng-template>
	</ion-modal>
</ion-content>