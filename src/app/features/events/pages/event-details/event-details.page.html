<app-header [title]="event?.Title || 'Event Details'"></app-header>

<ion-content [fullscreen]="true">
	<!-- Loading state -->
	<div *ngIf="isLoading" class="ion-padding">
		<ion-card>
			<ion-card-content>
				<div class="details-loading">
					<ion-skeleton-text animated
						style="width: 100%; height: 200px; border-radius: 8px; margin-bottom: 16px;"></ion-skeleton-text>
					<ion-skeleton-text animated style="width: 70%; height: 24px; margin-bottom: 12px;"></ion-skeleton-text>
					<ion-skeleton-text animated style="width: 60%; height: 18px; margin-bottom: 16px;"></ion-skeleton-text>
					<ion-skeleton-text animated style="width: 100%; height: 120px;"></ion-skeleton-text>
				</div>
			</ion-card-content>
		</ion-card>
	</div>

	<!-- Event details -->
	<div *ngIf="!isLoading && event">
		<!-- Main event image -->
		<div class="event-image-container" *ngIf="event.Main_Image?.url">
			<img [src]="getImageUrl()" [alt]="event.Title" (error)="onImageError($event)" class="event-main-image" />

			<!-- Live overlay for happening events -->
			<div class="live-overlay" *ngIf="isEventHappening()">
				<ion-badge color="success" class="live-badge">
					<ion-icon name="radio"></ion-icon>
					LIVE EVENT
				</ion-badge>
			</div>
		</div>

		<div class="ion-padding">
			<!-- Event header -->
			<ion-card class="event-main-card" [class.happening-now]="isEventHappening()">
				<ion-card-content>
					<div class="event-header">
						<h1 class="event-title">{{ event.Title }}</h1>

						<!-- Status badge -->
						<ion-chip *ngIf="isEventHappening()" color="success">
							<ion-icon name="radio"></ion-icon>
							<ion-label>Live Now</ion-label>
						</ion-chip>
						<ion-chip *ngIf="isEventUpcoming()" color="primary" outline>
							<ion-icon name="time"></ion-icon>
							<ion-label>Upcoming</ion-label>
						</ion-chip>
						<ion-chip *ngIf="isEventPast()" color="medium" outline>
							<ion-icon name="checkmark-circle"></ion-icon>
							<ion-label>Completed</ion-label>
						</ion-chip>
					</div>
				</ion-card-content>
			</ion-card>

			<!-- Event timing -->
			<ion-card>
				<ion-card-header>
					<ion-card-title>
						<ion-icon name="calendar"></ion-icon>
						Event Schedule
					</ion-card-title>
				</ion-card-header>
				<ion-card-content>
					<div class="event-timing">
						<!-- Same day event -->
						<div *ngIf="isSameDay(event.Start_Time, event.End_Time)">
							<div class="timing-item">
								<ion-icon name="calendar"></ion-icon>
								<div>
									<strong>Date</strong>
									<p>{{ formatDateOnly(event.Start_Time) }}</p>
								</div>
							</div>
							<div class="timing-item">
								<ion-icon name="time"></ion-icon>
								<div>
									<strong>Time</strong>
									<p>{{ formatTime(event.Start_Time) }} - {{ formatTime(event.End_Time) }}</p>
								</div>
							</div>
						</div>

						<!-- Multi-day event -->
						<div *ngIf="!isSameDay(event.Start_Time, event.End_Time)">
							<div class="timing-item">
								<ion-icon name="play"></ion-icon>
								<div>
									<strong>Starts</strong>
									<p>{{ formatDateTime(event.Start_Time) }}</p>
								</div>
							</div>
							<div class="timing-item">
								<ion-icon name="stop"></ion-icon>
								<div>
									<strong>Ends</strong>
									<p>{{ formatDateTime(event.End_Time) }}</p>
								</div>
							</div>
						</div>
					</div>
				</ion-card-content>
			</ion-card>

			<!-- Event description -->
			<ion-card>
				<ion-card-header>
					<ion-card-title>
						<ion-icon name="document-text"></ion-icon>
						Event Details
					</ion-card-title>
				</ion-card-header>
				<ion-card-content>
					<div class="event-body" [innerHTML]="event.Body"></div>
				</ion-card-content>
			</ion-card>

			<!-- Action buttons -->
			<div class="action-buttons">
				<ion-button expand="block" fill="outline" color="medium" (click)="goBack()">
					<ion-icon slot="start" name="arrow-back"></ion-icon>
					Back to Events
				</ion-button>
			</div>
		</div>